<script>
  // ---------------- VARIABLES ----------------
  let selectedCar = null;
  let daily = 0;
  let weekly = 0;
  let deposit = 0;

  // Example booked dates (format: YYYY-MM-DD)
  const bookedDates = {
    Camry: ['2026-02-01','2026-02-02'],
    Slingshot: ['2026-02-05']
  };

  // ---------------- SELECT CAR ----------------
  function selectCar(name, d, w, dep, el) {
    // remove highlight from all cars
    document.querySelectorAll('.car').forEach(c => c.classList.remove('selected'));
    // highlight selected car
    el.classList.add('selected');

    selectedCar = name;
    daily = d;
    weekly = w;
    deposit = dep;

    // update displayed car name
    document.getElementById('carName').innerText = name;

    // recalc total and check availability
    calculateTotal();
    checkAvailability();
  }

  // ---------------- CALCULATE TOTAL ----------------
  function calculateTotal() {
    const pick = new Date(document.getElementById('pickup').value);
    const ret = new Date(document.getElementById('return').value);

    if (!selectedCar || !pick || !ret || ret <= pick) return;

    const days = Math.ceil((ret - pick) / (1000 * 60 * 60 * 24));
    let cost = 0;

    if (weekly > 0 && days >= 7) {
      cost = Math.floor(days / 7) * weekly + (days % 7) * daily;
    } else {
      cost = days * daily;
    }

    cost += deposit; // add security deposit if applicable
    document.getElementById('total').innerText = cost;
  }

  // ---------------- CHECK AVAILABILITY ----------------
  function checkAvailability() {
    const pick = document.getElementById('pickup').value;
    const ret = document.getElementById('return').value;
    const status = document.getElementById('availability');

    if (!selectedCar || !pick || !ret) {
      status.innerText = '';
      return;
    }

    const dates = bookedDates[selectedCar] || [];
    if (dates.includes(pick) || dates.includes(ret)) {
      status.innerText = '❌ Not available for selected dates';
      status.style.color = 'red';
    } else {
      status.innerText = '✅ Available';
      status.style.color = 'green';
    }
  }

  // ---------------- RESERVE ----------------
  function reserve() {
    const email = document.getElementById('email').value;
    const agree = document.getElementById('agree').checked;

    if (!selectedCar) {
      alert('Please select a vehicle');
      return;
    }
    if (!email) {
      alert('Please enter your email');
      return;
    }
    if (!agree) {
      alert('You must agree to the Rental Agreement & Terms before paying');
      return;
    }

    // Here you can add email sending / payment integration later
    alert('✅ Reservation request sent! We will contact you shortly.');
  }
</script>
